import{_ as n,p as a,q as s,a1 as t}from"./framework-c4f3d865.js";const e={},p=t(`<h1 id="问题记录" tabindex="-1"><a class="header-anchor" href="#问题记录" aria-hidden="true">#</a> 问题记录</h1><h3 id="_1-ios-点击视频会自动全屏" tabindex="-1"><a class="header-anchor" href="#_1-ios-点击视频会自动全屏" aria-hidden="true">#</a> 1. iOS 点击视频会自动全屏</h3><p>需要给 video 标签上加上 playsinline 属性</p><h3 id="_2-刘海屏适配" tabindex="-1"><a class="header-anchor" href="#_2-刘海屏适配" aria-hidden="true">#</a> 2. 刘海屏适配</h3><div class="language-html" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport-fit=cover<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector">body</span> <span class="token punctuation">{</span>
        <span class="token property">padding-top</span><span class="token punctuation">:</span> <span class="token function">constant</span><span class="token punctuation">(</span>safe-area-inset-top<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token property">padding-top</span><span class="token punctuation">:</span> <span class="token function">env</span><span class="token punctuation">(</span>safe-area-inset-top<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token property">padding-bottom</span><span class="token punctuation">:</span> <span class="token function">constant</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token property">padding-bottom</span><span class="token punctuation">:</span> <span class="token function">env</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_3-小程序-image-onload-不触发" tabindex="-1"><a class="header-anchor" href="#_3-小程序-image-onload-不触发" aria-hidden="true">#</a> 3. 小程序 image onload 不触发</h3><p>部分机型在已缓存过图片的情况下，会有这个问题，手动触发一下</p><div class="language-javascript" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> image <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">createImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
image<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">&quot;xxx&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>func<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
image<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_4-设置-element-style-xxx-无效" tabindex="-1"><a class="header-anchor" href="#_4-设置-element-style-xxx-无效" aria-hidden="true">#</a> 4. 设置 element.style.xxx 无效</h3><p>在部分电视机顶盒的 webview 上遇到过，手动触发浏览器重绘后，属性也没生效。 可尝试使用 <code>element.style.setProperty</code> 和 <code>element.style.cssText</code>，一般会有其中一个兼容。</p><h3 id="_5-resize-事件监听在-ios-横屏时没触发" tabindex="-1"><a class="header-anchor" href="#_5-resize-事件监听在-ios-横屏时没触发" aria-hidden="true">#</a> 5. resize 事件监听在 iOS 横屏时没触发</h3><p>安卓横屏正常触发 resize 事件监听，iOS 需要额外监听 orientationchange 横屏事件</p><h3 id="_6-动画时-element-getboundingclientrect-获取的数值在与动画后不同" tabindex="-1"><a class="header-anchor" href="#_6-动画时-element-getboundingclientrect-获取的数值在与动画后不同" aria-hidden="true">#</a> 6. 动画时，element.getBoundingClientRect 获取的数值在与动画后不同</h3><p>通过 offsetParent 获取</p><div class="language-javascript" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">let</span> el <span class="token operator">=</span> element<span class="token punctuation">;</span>
<span class="token keyword">let</span> offsetLeft <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>el<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    offsetLeft <span class="token operator">+=</span> el<span class="token punctuation">.</span>offsetLeft<span class="token punctuation">;</span>
    el <span class="token operator">=</span> el<span class="token punctuation">.</span>offsetParent<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_7-在没有滚动条的情况下-按上方向键-页面整体上移" tabindex="-1"><a class="header-anchor" href="#_7-在没有滚动条的情况下-按上方向键-页面整体上移" aria-hidden="true">#</a> 7. 在没有滚动条的情况下，按上方向键，页面整体上移</h3><p>电视盒子 webview 页面没有内容溢出，没有出现滚动条，但在按上方向键时，页面会整体上移。</p><p>使用 <code>document.body.getBoundingClientRect()</code> 发现 body 的 y 值是负的，也就是 body 往上偏移了， 但 body 的样式上并没有 top、transform 等可能造成偏移的属性。</p><p>经过调试，发现 webview 可能被运营商魔改过，上方向键存在默认行为，阻止默认行为即可。</p><div class="language-javascript" data-ext="js"><pre class="language-javascript"><code>document<span class="token punctuation">.</span><span class="token function-variable function">onkeydown</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    evt<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>`,20),o=[p];function c(l,u){return a(),s("div",null,o)}const r=n(e,[["render",c],["__file","record.html.vue"]]);export{r as default};
